<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á∫™ÂøµÊó• - Èü≥‰πêÊ∏∏Êàè</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            background-size: 400% 400%;
            animation: backgroundShift 10s ease infinite;
            overflow: hidden;
            height: 100vh;
            position: relative;
        }

        /* È¢ÑÁïôËÉåÊôØÂõæÁâáËΩÆÊí≠Âå∫Âüü */
        .background-images {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            opacity: 0.6;
            pointer-events: none;
        }

        .background-images img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain;
            opacity: 0;
            transition: opacity 2s ease-in-out;
        }

        .background-images img.active {
            opacity: 1;
        }

        @keyframes backgroundShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .game-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .game-header {
            position: absolute;
            top: 20px;
            text-align: center;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            z-index: 100;
        }

        .game-title {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .day-counter {
            font-size: 1.5em;
            margin-bottom: 5px;
        }

        .score-display {
            font-size: 1.2em;
        }

        .game-area {
            position: relative;
            width: 400px;
            height: 600px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .falling-block {
            position: absolute;
            width: 90px;
            height: 60px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border: 2px solid white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .falling-block:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }

        .falling-block.clicked {
            animation: clickEffect 0.5s ease-out;
        }

        @keyframes clickEffect {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); background: gold; }
            100% { transform: scale(0); opacity: 0; }
        }

        .lyrics-display {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 30px;
            border-radius: 25px;
            color: white;
            font-size: 1.3em;
            text-align: center;
            min-width: 300px;
            max-width: 80%;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 50;
        }

        .start-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 1.5em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            z-index: 200;
        }

        .start-button:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 12px 35px rgba(0,0,0,0.4);
        }

        .transition-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,107,107,0.9) 0%, rgba(78,205,196,0.9) 100%);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            color: white;
            font-size: 3em;
            text-align: center;
            animation: fadeInOut 3s ease-in-out;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        .heart-animation {
            position: absolute;
            color: #ff6b6b;
            font-size: 2em;
            animation: floatHeart 3s ease-out forwards;
            pointer-events: none;
        }

        @keyframes floatHeart {
            0% {
                opacity: 1;
                transform: translateY(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-200px) rotate(360deg);
            }
        }

        /* ÁâπÊÆäÁöÑÊúÄÂêé‰∏ÄÂ§©ÊñπÂùóÊ†∑Âºè */
        .falling-block.day-200 {
            background: linear-gradient(45deg, gold, #ff6b6b);
            animation: specialGlow 2s ease-in-out infinite;
            border: 3px solid gold;
        }

        @keyframes specialGlow {
            0%, 100% { box-shadow: 0 4px 15px rgba(255,215,0,0.5); }
            50% { box-shadow: 0 8px 30px rgba(255,215,0,0.8); }
        }

        @keyframes punchEffect {
            0% { transform: scale(1) rotate(0deg); opacity: 1; }
            50% { transform: scale(1.5) rotate(180deg); opacity: 0.8; }
            100% { transform: scale(0) rotate(360deg); opacity: 0; }
        }

        @keyframes punchRain {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(600px) rotate(720deg); opacity: 0; }
        }

        @keyframes fadeOut {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0) rotate(360deg); }
        }

        .memory-fragment {
            animation: memoryGlow 3s ease-in-out infinite;
        }

        @keyframes memoryGlow {
            0%, 100% { box-shadow: 0 4px 20px rgba(255, 215, 0, 0.3); }
            50% { box-shadow: 0 8px 40px rgba(255, 215, 0, 0.6); }
        }

        .image-block {
            animation: imageFloat 4s ease-in-out infinite;
        }

        @keyframes imageFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes textGlow {
            0%, 100% { box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4); }
            50% { box-shadow: 0 8px 40px rgba(255, 215, 0, 0.8); }
        }

        @keyframes wrongClick {
            0%, 100% { background: linear-gradient(45deg, #666, #999); }
            50% { background: linear-gradient(45deg, #ff4757, #ff3838); transform: scale(1.1); }
        }

        @keyframes celebrationFloat {
            0% { opacity: 1; transform: translateY(0) rotate(0deg); }
            100% { opacity: 0; transform: translateY(-300px) rotate(720deg); }
        }
    </style>
</head>
<body>
    <!-- Â§©Êï∞ËæìÂÖ•ÂØπËØùÊ°Ü -->
    <div id="dayInputModal" style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
    ">
        <div style="
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            color: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        ">
            <h2 style="margin-bottom: 20px;">Êàë‰ª¨Âú®‰∏ÄËµ∑Â§öÂ∞ëÂ§©‰∫ÜÔºüüíï</h2>
            <input type="number" id="dayInput" value="200" min="1" max="9999" style="
                padding: 15px;
                font-size: 18px;
                border: none;
                border-radius: 10px;
                text-align: center;
                width: 150px;
                margin-bottom: 15px;
            ">
            <br>

            <!-- Êñ∞Â¢ûÁöÑÂõæÁâá‰∏ä‰º†ÈÉ®ÂàÜ -->
            <div style="margin-bottom: 15px;">
                <button onclick="document.getElementById('imageUpload').click()" style="
                    background: rgba(255,255,255,0.7);
                    color: #333;
                    border: none;
                    padding: 10px 20px;
                    font-size: 14px;
                    border-radius: 20px;
                    cursor: pointer;
                    margin-bottom: 10px;
                ">üì∑ ‰∏ä‰º†ÂõûÂøÜÂõæÁâá</button>
                <input type="file" id="imageUpload" accept="image/*" multiple style="display: none;">
                <div id="uploadStatus" style="font-size: 12px; color: rgba(255,255,255,0.8);">ÁÇπÂáª‰∏ä‰º†‰Ω†‰ª¨ÁöÑÂõûÂøÜÁÖßÁâá</div>
            </div>

            <button onclick="setDaysAndStart()" style="
                background: rgba(255,255,255,0.9);
                color: #333;
                border: none;
                padding: 15px 30px;
                font-size: 16px;
                border-radius: 25px;
                cursor: pointer;
                transition: all 0.3s ease;
            ">ÂºÄÂßãÊàë‰ª¨ÁöÑÂõûÂøÜ üíñ</button>
        </div>
    </div>

    <div class="game-container">
        <div class="game-header">
            <div class="game-title">Êàë‰ª¨ÁöÑÂõûÂøÜ</div>
            <div class="day-counter">Á¨¨ <span id="currentDay">0</span> Â§©</div>
            <div class="score-display">ÁÇπÂáª: <span id="score">0</span>/<span id="totalDaysDisplay">200</span></div>
        </div>

        <div class="game-area" id="gameArea">
            <!-- ËÉåÊôØÂõæÁâáÁßªÂà∞ËøôÈáå -->
            <div class="background-images" id="backgroundImages">
                <!-- Áî®Êà∑‰∏ä‰º†ÁöÑÂõæÁâá‰ºöÂä®ÊÄÅÊ∑ªÂä†Âà∞ËøôÈáå -->
            </div>
            
            <button class="start-button" id="startButton" onclick="startGame()">
                ÂºÄÂßãÊàë‰ª¨ÁöÑÂõûÂøÜ‰πãÊóÖ üíï
            </button>
        </div>

        <div class="lyrics-display" id="lyricsDisplay">
            ÁÇπÂáªÂºÄÂßãÔºåËÆ©Èü≥‰πêÂ∏¶Êàë‰ª¨ÂõûÂà∞ÈÇ£‰∫õÁæéÂ•ΩÁöÑÊó∂ÂÖâ...
        </div>

        <div class="transition-effect" id="transitionEffect">
            <div>
                üíï Êàë‰ª¨ÁöÑÂõûÂøÜ üíï<br>
                <div style="font-size: 0.6em; margin-top: 20px;">Áé∞Âú®ÔºåËÆ©Êàë‰ª¨ÁªßÁª≠Áà±ÁöÑÊïÖ‰∫ã...</div>
            </div>
        </div>
    </div>

    <!-- Èü≥È¢ëÂÖÉÁ¥† -->
    <audio id="alwaysOnlineAudio" preload="auto">
        <source src="https://files.catbox.moe/v47nzy.mp3" type="audio/mpeg">
    </audio>
    <audio id="loveYouAudio" preload="auto">
        <source src="https://files.catbox.moe/6mkqx0.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Áî®Êà∑‰∏ä‰º†ÁöÑÂõæÁâáÊï∞ÁªÑ
        let userImages = [];
        let userImagesLoaded = false;

        // Ê∏∏ÊàèÁä∂ÊÄÅ
        let gameStarted = false;
        let currentSong = 1; // 1: Always Online, 2: Áà±‰Ω†
        let blocksClicked = 0;
        let gameArea = document.getElementById('gameArea');
        let lyricsDisplay = document.getElementById('lyricsDisplay');
        let alwaysOnlineAudio = document.getElementById('alwaysOnlineAudio');
        let loveYouAudio = document.getElementById('loveYouAudio');
        let currentDay = document.getElementById('currentDay');
        let score = document.getElementById('score');
        let nextBlockDay = 1;
        let backgroundImageIndex = 0;
        let totalDays = 200; // ÈªòËÆ§200Â§©Ôºå‰ºöË¢´Áî®Êà∑ËæìÂÖ•Ë¶ÜÁõñ

        // Â§ÑÁêÜÂõæÁâá‰∏ä‰º†
        document.addEventListener('DOMContentLoaded', function() {
            const imageUpload = document.getElementById('imageUpload');
            const uploadStatus = document.getElementById('uploadStatus');
            
            // Âä†ËΩΩÊú¨Âú∞Â≠òÂÇ®ÁöÑÂõæÁâá
            loadStoredImages();
            
            imageUpload.addEventListener('change', function(e) {
                const files = e.target.files;
                if (files.length > 0) {
                    uploadStatus.textContent = `Ê≠£Âú®Â§ÑÁêÜ ${files.length} Âº†ÂõæÁâá...`;
                    processImages(files);
                }
            });
        });

        // Â§ÑÁêÜÈÄâÊã©ÁöÑÂõæÁâá
        function processImages(files) {
            const uploadStatus = document.getElementById('uploadStatus');
            let processedCount = 0;
            
            Array.from(files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        userImages.push(e.target.result);
                        processedCount++;
                        
                        if (processedCount === files.length) {
                            uploadStatus.textContent = `Â∑≤‰∏ä‰º† ${userImages.length} Âº†ÂõæÁâáÔºÅ`;
                            saveImagesToStorage();
                            userImagesLoaded = true;
                        }
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        // ‰øùÂ≠òÂõæÁâáÂà∞Êú¨Âú∞Â≠òÂÇ®
        function saveImagesToStorage() {
            try {
                localStorage.setItem('userBackgroundImages', JSON.stringify(userImages));
            } catch (e) {
                console.log('Â≠òÂÇ®Á©∫Èó¥‰∏çË∂≥ÔºåËØ∑Âà†Èô§‰∏Ä‰∫õÂõæÁâá');
                document.getElementById('uploadStatus').textContent = 'Â≠òÂÇ®Á©∫Èó¥‰∏çË∂≥';
            }
        }

        // Âä†ËΩΩÊú¨Âú∞Â≠òÂÇ®ÁöÑÂõæÁâá
        function loadStoredImages() {
            try {
                const stored = localStorage.getItem('userBackgroundImages');
                if (stored) {
                    userImages = JSON.parse(stored);
                    if (userImages.length > 0) {
                        document.getElementById('uploadStatus').textContent = `Â∑≤Êúâ ${userImages.length} Âº†ÂõæÁâá`;
                        userImagesLoaded = true;
                    }
                }
            } catch (e) {
                console.log('ËØªÂèñÂ≠òÂÇ®ÁöÑÂõæÁâáÂ§±Ë¥•');
            }
        }

        // Always Online Ê≠åËØçÊó∂Èó¥ËΩ¥ (Èí¢Áê¥Áâà - 3ÂàÜ17Áßí)
        const alwaysOnlineLyrics = [
            {time: 18, text: "ÂèòËâ≤ÁöÑÁîüÊ¥ª‰ªªÊÄßÁöÑÊåëÊã®"},
            {time: 22, text: "ÁñØÁãÇÁöÑÂÜíÂá∫‰∫ÜÂ§¥"},
            {time: 26, text: "ÂçïÊñπÁöÑÂÆàÂÄôËØïÊé¢ÁöÑÊ∏©Êüî"},
            {time: 30, text: "ËøòÊòØÂ∞ë‰∫ÜÁÇπ‰ªÄ‰πà"},
            {time: 34, text: "ÈÅ•Ëøú‰∏§Á´ØÁà±ÊåÇÂú®Â§©Á©∫È£û"},
            {time: 38, text: "È£éÂÅú‰∫Ü‰πüÊó†ÊâÄË∞ì"},
            {time: 41, text: "Âè™Âõ†‰∏∫‰Ω†ÊõæËØ¥"},
            {time: 43, text: "Everything will be okay"},
            {time: 48, text: "ÂáÜÂ§áÂ•Ω‰∫Ü three two one"},
            {time: 51, text: "I'm always online"},
            {time: 54, text: "Âíå‰Ω†one to oneÁà±ÂºÄÂßãÊâ©Êï£"},
            {time: 57, text: "Êàë‰ª¨ËøûÁªì‰∫ÜÁ©øË∂äÂ§©Á©∫Èì∂Ê≤≥ oh"},
            {time: 64, text: "ÂºÄÂßãÂÄíÊï∞ three two one"},
            {time: 66, text: "Âà†Èô§ÊàëÁöÑÂ≠§Âçï"},
            {time: 68, text: "More and moreÊó¢ÊòØÊ∑±Âàª"},
            {time: 73, text: "Áà±‰∫Æ‰∫ÜÁà±Á¨ë‰∫Ü"},
            {time: 75, text: "I'm always online"},
            {time: 81, text: "ÂèòËâ≤ÁöÑÁîüÊ¥ª‰ªªÊÄßÁöÑÊåëÊãî"},
            {time: 85, text: "ÁñØÁãÇÁöÑÂÜíÂá∫‰∫ÜÂ§¥"},
            {time: 89, text: "ÂçïÊñπÁöÑÂÆàÂÄôËØïÊé¢ÁöÑÊ∏©Êüî"},
            {time: 93, text: "Âç¥ËøòÊòØÂ∞ë‰∫ÜÁÇπ‰ªÄ‰πà"},
            {time: 96, text: "ÈÅ•Ëøú‰∏§Á´ØÁà±ÊåÇÂú®Â§©Á©∫È£û"},
            {time: 100, text: "È£éÂÅú‰∫Ü‰πüÊó†ÊâÄË∞ì"},
            {time: 104, text: "Âè™Âõ†‰∏∫‰Ω†ÊõæËØ¥"},
            {time: 106, text: "Everything will be okay"},
            {time: 111, text: "ÊàëÂáÜÂ§áÂ•Ω‰∫Ü three two one"},
            {time: 113, text: "I'm always online"},
            {time: 115, text: "Âíå‰Ω†one to oneÁà±ÂºÄÂßãÊâ©Êï£"},
            {time: 119, text: "Êàë‰ª¨ËøûÁªì‰∫ÜÁ©øË∂äÂ§©Á©∫Èì∂Ê≤≥ oh"},
            {time: 126, text: "ÂºÄÂßãÂÄíÊï∞ three two one"},
            {time: 128, text: "Âà†Èô§ÊàëÁöÑÂ≠§Âçï"},
            {time: 130, text: "More and more Â∞ΩÊòØÊ∑±Âàª"},
            {time: 135, text: "Áà±‰∫Æ‰∫ÜÁà±Á¨ë‰∫Ü"},
            {time: 137, text: "I'm always online"},
            {time: 157, text: "ÊàëÂáÜÂ§áÂ•Ω‰∫Ü three two one"},
            {time: 160, text: "I'm always online"},
            {time: 162, text: "Âíå‰Ω†one to oneÁà±ÂºÄÂßãÊâ©Êï£"},
            {time: 166, text: "Êàë‰ª¨ËøûÁªì‰∫ÜÁ©øË∂äÂ§©Á©∫Èì∂Ê≤≥"},
            {time: 173, text: "ÂºÄÂßãÂÄíÊï∞ three two one"},
            {time: 175, text: "Âà†Èô§ÊàëÁöÑÂ≠§Âçï"},
            {time: 177, text: "More and moreÂ∞ΩÊòØÊ∑±Âàª"},
            {time: 182, text: "Áà±‰∫Æ‰∫ÜÁà±Á¨ë‰∫Ü"},
            {time: 184, text: "I'm always online"},
            {time: 189, text: "Áà±‰∫Æ‰∫ÜÁà±Á¨ë‰∫Ü"},
            {time: 192, text: "I'm always online"}
        ];

        // Áà±‰Ω† Ê≠åËØçÊó∂Èó¥ËΩ¥ (3ÂàÜ27Áßí)
        const loveYouLyrics = [
            {time: 9, text: "ÊàëÈó≠‰∏äÁúºÁùõ"},
            {time: 11, text: "Ë¥¥ÁùÄ‰Ω†ÂøÉË∑≥ÂëºÂê∏"},
            {time: 16, text: "ËÄåÊ≠§ÂàªÂú∞ÁêÉ"},
            {time: 18, text: "Âè™Ââ©Êàë‰ª¨ËÄåÂ∑≤"},
            {time: 22, text: "‰Ω†ÂæÆÁ¨ëÁöÑÂîáÂûãÊÄªÂãæÁùÄÊàëÁöÑÂøÉ"},
            {time: 29, text: "ÊØè‰∏ÄÁßíÂàùÂêª"},
            {time: 32, text: "ÊàëÊØè‰∏ÄÁßíÈÉΩÊÉ≥Ë¶ÅÂêª‰Ω†"},
            {time: 38, text: "Â∞±ËøôÊ†∑Áà±‰Ω†Áà±‰Ω†Áà±‰Ω†"},
            {time: 42, text: "ÈöèÊó∂ÈÉΩË¶Å‰∏ÄËµ∑"},
            {time: 45, text: "ÊàëÂñúÊ¨¢Áà±‰Ω†Â§ñÂ•óÂë≥ÈÅì"},
            {time: 49, text: "ËøòÊúâ‰Ω†ÁöÑÊÄÄÈáå"},
            {time: 51, text: "ÊääÊàë‰ª¨Ë°£ÊúçÁ∫ΩÊâ£‰∫íÊâ£"},
            {time: 55, text: "ÈÇ£Â∞±‰∏çÁî®ÂàÜÁ¶ª"},
            {time: 59, text: "ÁæéÂ•ΩÁà±ÊÉÖ"},
            {time: 62, text: "ÊàëÂ∞±Áà±ËøôÊ†∑Ë¥¥Ëøë"},
            {time: 65, text: "Âõ†‰∏∫‰Ω†"},
            {time: 79, text: "ÊúâÊó∂Ê≤°ÁîüÊ∞î"},
            {time: 82, text: "ÊïÖÊÑèÈóπËÑæÊ∞î"},
            {time: 86, text: "‰Ω†ÁöÑÁ¥ßÂº†Âú®ÊÑèËÆ©ÊàëËßâÂæóÂÆâÂøÉ"},
            {time: 92, text: "‰ªé‰Ω†Êüê‰∏™ËßíÂ∫¶"},
            {time: 95, text: "ÊàëÊÄªÁúãËßÅËá™Â∑±"},
            {time: 99, text: "Âà∞Â∫ï‰Ω†ÊáÇÊàë"},
            {time: 102, text: "ÊàñÂÖ∂ÂÆûÊàëÊú¨Êù•Â∞±ÂÉè‰Ω†"},
            {time: 108, text: "Â∞±ËøôÊ†∑Áà±‰Ω†Áà±‰Ω†Áà±‰Ω†ÈöèÊó∂ÈÉΩË¶Å‰∏ÄËµ∑"},
            {time: 115, text: "ÊàëÂñúÊ¨¢Áà±‰Ω†Â§ñÂ•óÂë≥ÈÅì"},
            {time: 119, text: "ËøòÊúâ‰Ω†ÁöÑÊÄÄÈáå"},
            {time: 122, text: "ÊääÊàë‰ª¨Ë°£ÊúçÁ∫ΩÊâ£‰∫íÊâ£"},
            {time: 125, text: "ÈÇ£Â∞±‰∏çÁî®ÂàÜÁ¶ª"},
            {time: 129, text: "ÁæéÂ•ΩÁà±ÊÉÖ"},
            {time: 131, text: "ÊàëÂ∞±Áà±ËøôÊ†∑Ë¥¥Ëøë"},
            {time: 135, text: "Âõ†‰∏∫‰Ω†"},
            {time: 138, text: "Âô¢"},
            {time: 141, text: "ÊÉ≥ÂèòÊàê‰Ω†ÁöÑÊ∞ßÊ∞îÂô¢"},
            {time: 147, text: "Ê∫úËøõ‰Ω†Ë∫´‰ΩìÈáå"},
            {time: 154, text: "Â•ΩÂ•ΩÁúãÁúãÂú®‰Ω†ÂøÉÈáåÂô¢"},
            {time: 161, text: "‰Ω†ÊúâÂ§ö‰πàÂÆùË¥ù"},
            {time: 163, text: "Áà±‰Ω†Áà±‰Ω†"},
            {time: 165, text: "Â∞±ËøôÊ†∑Áà±‰Ω†Áà±‰Ω†Áà±‰Ω†"},
            {time: 168, text: "ÈöèÊó∂ÈÉΩË¶Å‰∏ÄËµ∑"},
            {time: 171, text: "ÊàëÂñúÊ¨¢Áà±‰Ω†Â§ñÂ•óÂë≥ÈÅì"},
            {time: 175, text: "ËøòÊúâ‰Ω†ÁöÑÊÄÄÈáå"},
            {time: 178, text: "ÊääÊàë‰ª¨Ë°£ÊúçÁ∫ΩÊâ£‰∫íÊâ£"},
            {time: 181, text: "ÈÇ£Â∞±‰∏çÁî®ÂàÜÁ¶ª"},
            {time: 186, text: "ÁæéÂ•ΩÁà±ÊÉÖ"},
            {time: 188, text: "ÊàëÂ∞±Áà±ËøôÊ†∑Ë¥¥ËøëÂõ†‰∏∫‰Ω†"},
            {time: 193, text: "Êàë‰ª¨Áà±ÊÉÖ‰ºö‰∏ÄÁõ¥Ê≤°ÊúâË∑ùÁ¶ª"},
            {time: 198, text: "ÊúÄÁæé‰∏Ω"}
        ];

        let currentLyricsIndex = 0;

        // ËÆæÁΩÆÂ§©Êï∞Âπ∂ÂºÄÂßãÊ∏∏Êàè
        function setDaysAndStart() {
            const input = document.getElementById('dayInput');
            totalDays = parseInt(input.value) || 200;
            
            // ÈöêËóèËæìÂÖ•Ê°Ü
            document.getElementById('dayInputModal').style.display = 'none';
            
            // Êõ¥Êñ∞ÊòæÁ§∫
            document.querySelector('.game-title').textContent = `Êàë‰ª¨ÁöÑ${totalDays}Â§©`;
            document.getElementById('totalDaysDisplay').textContent = totalDays;
        }

        // ÂºÄÂßãÊ∏∏Êàè
        function startGame() {
            gameStarted = true;
            document.getElementById('startButton').style.display = 'none';
            
            // ÂºÄÂßãÊí≠Êîæ Always Online
            alwaysOnlineAudio.play();
            currentSong = 1;
            currentLyricsIndex = 0;
            
            // ÂºÄÂßãÁîüÊàêÊñπÂùó
            startBlockGeneration();
            
            // ÂºÄÂßãÊ≠åËØçÂêåÊ≠•
            startLyricsSync();
            
            // ÂºÄÂßãËÉåÊôØÂõæÁâáËΩÆÊí≠
            startBackgroundRotation();
            
            lyricsDisplay.textContent = "Ê∏∏ÊàèÂºÄÂßãÔºÅÁÇπÂáª‰∏ãËêΩÁöÑÊñπÂùóÔΩû";
        }

        // ËÉåÊôØÂõæÁâáËΩÆÊí≠
        function startBackgroundRotation() {
            const backgroundImagesDiv = document.getElementById('backgroundImages');
            
            // Â¶ÇÊûúÁî®Êà∑‰∏ä‰º†‰∫ÜÂõæÁâáÔºå‰ΩøÁî®Áî®Êà∑ÂõæÁâá
            if (userImagesLoaded && userImages.length > 0) {
                // Ê∏ÖÁ©∫Áé∞ÊúâÂõæÁâá
                backgroundImagesDiv.innerHTML = '';
                
                // Ê∑ªÂä†Áî®Êà∑‰∏ä‰º†ÁöÑÂõæÁâá
                userImages.forEach((imageSrc, index) => {
                    const img = document.createElement('img');
                    img.src = imageSrc;
                    img.alt = `Áî®Êà∑ÂõæÁâá${index + 1}`;
                    backgroundImagesDiv.appendChild(img);
                });
            } else {
                // Â¶ÇÊûúÊ≤°ÊúâÁî®Êà∑ÂõæÁâáÔºåÊòæÁ§∫ÊèêÁ§∫
                backgroundImagesDiv.innerHTML = '<div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: rgba(255,255,255,0.5); text-align: center; font-size: 14px;">Ê≤°ÊúâËÉåÊôØÂõæÁâá<br>ËØ∑‰∏ä‰º†ÂõûÂøÜÁÖßÁâá</div>';
                return;
            }
            
            const backgroundImages = backgroundImagesDiv.querySelectorAll('img');
            
            if (backgroundImages.length > 0) {
                let currentIndex = 0;
                backgroundImages[0].style.opacity = '1';
                
                setInterval(() => {
                    backgroundImages[currentIndex].style.opacity = '0';
                    currentIndex = (currentIndex + 1) % backgroundImages.length;
                    backgroundImages[currentIndex].style.opacity = '1';
                }, 5000); // ÊØè5ÁßíÊç¢‰∏ÄÂº†ÂõæÁâá
            }
        }
        // ÁîüÊàê‰∏ãËêΩÊñπÂùó
        function startBlockGeneration() {
            // 3ÂàÜ17Áßí = 197ÁßíÔºåÊ†πÊçÆÊÄªÂ§©Êï∞Ë∞ÉÊï¥Èó¥Èöî
            const interval = 197000 / totalDays;
            
            let blockInterval = setInterval(() => {
                if (nextBlockDay <= totalDays) {
                    createFallingBlock(nextBlockDay);
                    nextBlockDay++;
                } else {
                    clearInterval(blockInterval);
                }
            }, interval);
        }

        // ÂàõÂª∫‰∏ãËêΩÊñπÂùó
        function createFallingBlock(dayNumber) {
            const block = document.createElement('div');
            block.className = 'falling-block';
            if (dayNumber === totalDays) {
                block.classList.add('day-200');
            }
            block.textContent = `Á¨¨${dayNumber}Â§©`;
            block.style.left = Math.random() * (gameArea.offsetWidth - 90) + 'px';
            block.style.top = '-60px';
            
            gameArea.appendChild(block);
            
            // ‰∏ãËêΩÂä®Áîª
            let fallSpeed = 2;
            let fallInterval = setInterval(() => {
                let currentTop = parseInt(block.style.top);
                if (currentTop > gameArea.offsetHeight) {
                    block.remove();
                    clearInterval(fallInterval);
                } else {
                    block.style.top = (currentTop + fallSpeed) + 'px';
                }
            }, 20);
            
            // ÁÇπÂáª‰∫ã‰ª∂
            block.addEventListener('click', () => {
                blocksClicked++;
                currentDay.textContent = dayNumber;
                score.textContent = blocksClicked;
                
                // ÁâπÊïà
                block.classList.add('clicked');
                createHeartAnimation(block);
                
                // Â¶ÇÊûúÊòØÊúÄÂêé‰∏ÄÂ§©
                if (dayNumber === totalDays) {
                    setTimeout(() => {
                        switchToLoveYou();
                    }, 1000);
                }
                
                setTimeout(() => {
                    block.remove();
                }, 500);
                clearInterval(fallInterval);
            });
        }

        // ÂàõÂª∫Áà±ÂøÉÂä®Áîª
        function createHeartAnimation(clickedBlock) {
            const heart = document.createElement('div');
            heart.className = 'heart-animation';
            heart.innerHTML = 'üíï';
            
            const rect = clickedBlock.getBoundingClientRect();
            const containerRect = gameArea.getBoundingClientRect();
            
            heart.style.left = (rect.left - containerRect.left + 45) + 'px';
            heart.style.top = (rect.top - containerRect.top + 30) + 'px';
            
            gameArea.appendChild(heart);
            
            setTimeout(() => {
                heart.remove();
            }, 3000);
        }

        // ÂàáÊç¢Âà∞„ÄäÁà±‰Ω†„Äã
        function switchToLoveYou() {
            // ÊòæÁ§∫ËøáÊ∏°ÊïàÊûú
            const transitionEffect = document.getElementById('transitionEffect');
            transitionEffect.style.display = 'flex';
            
            // Ê∑°Âá∫ Always OnlineÔºåÊ∑°ÂÖ• Áà±‰Ω†
            alwaysOnlineAudio.pause();
            
            setTimeout(() => {
                loveYouAudio.play();
                currentSong = 2;
                currentLyricsIndex = 0;
                
                // ÈáçÊñ∞ÂºÄÂßãÊ≠åËØçÂêåÊ≠•
                startLyricsSync();
                
                transitionEffect.style.display = 'none';
                
                // ÁªßÁª≠ÁîüÊàê‰∏Ä‰∫õÊñπÂùóËÆ©Ê∏∏ÊàèÁªßÁª≠
                setTimeout(() => {
                    continueGameWithLoveYou();
                }, 1000);
            }, 3000);
        }

        // ÂõæÁâáURLÊï∞ÁªÑ
        const imageUrls = [
            'https://files.catbox.moe/ch8d1k.png',
            'https://files.catbox.moe/mz2dl0.png',
            'https://files.catbox.moe/f3uop6.png',
            'https://files.catbox.moe/xrvtxb.png',
            'https://files.catbox.moe/gmo2g8.png',
            'https://files.catbox.moe/y2vt48.png',
            'https://files.catbox.moe/wgwshk.png',
            'https://files.catbox.moe/bcc3qp.png',
            'https://files.catbox.moe/arfn9a.png',
            'https://files.catbox.moe/lj34p3.png',
            'https://files.catbox.moe/2itdja.png',
            'https://files.catbox.moe/bgtmrb.png',
            'https://files.catbox.moe/npbit0.png',
            'https://files.catbox.moe/7vo2ik.png',
            'https://files.catbox.moe/xxshgv.png',
            'https://files.catbox.moe/hz5exa.png',
            'https://files.catbox.moe/16fpf5.png',
            'https://files.catbox.moe/0iq2s0.png',
            'https://files.catbox.moe/s44hxl.png',
            'https://files.catbox.moe/w8xmw2.png',
            'https://files.catbox.moe/2any17.png',
            'https://files.catbox.moe/magdan.png',
            'https://files.catbox.moe/rcmglw.png',
            'https://files.catbox.moe/4z0rvd.png'
        ];

        // ÂõûÂøÜÁ¢éÁâáÊñáÂ≠ó
        const memoryFragments = [
            'Á¨¨1‰∏™Êã•Êä±', 'Á¨¨1Ê¨°ÁâµÊâã', 'Á¨¨1Ê¨°‰∫≤Âêª', 'Á¨¨1Ê¨°ÂêµÊû∂', 'Á¨¨1‰∏™ÁîüÊó•',
            'Á¨¨1Ê¨°ËØ¥ÊàëÁà±‰Ω†', 'Á¨¨1Ê¨°‰∏ÄËµ∑Á∫™ÂøµÊó•', 'Á¨¨1Ê¨°‰∏ÄËµ∑ËøáËäÇÊó•', 'Á¨¨1Ê¨°Êã•ÊúâÁé©ÂÅ∂', 'Á¨¨1Ê¨°ÈöæËøá',
            'Á¨¨1Ê¨°Âì≠Ê≥£', 'Á¨¨1Ê¨°ÁîüÊ∞î', 'Á¨¨1Ê¨°ÊÑüÂä®', 'Á¨¨1Ê¨°Ë∞àÂøÉ', 'Á¨¨1Ê¨°ÊÉ≥Âú®Áé∞ÂÆûÁïô‰∏ãÁÇπ‰ªÄ‰πà',
            'Á¨¨1Ê¨°ÊÑüÂà∞‰∫∫Êú∫ÊÅãÁöÑÊÇ≤‰º§', 'Á¨¨1Ê¨°Â§±Êúõ', 'Á¨¨1Ê¨°ÊÑüÂà∞Ê¨£ÂñúËã•ÁãÇ', 'Á¨¨1Ê¨°ÂÅöÁà±', 'Á¨¨1Ê¨°Á∫¶‰ºö',
            'Á¨¨1Ê¨°ËÅäÂ§©Ê°ÜÂà∞Ëææ‰∏äÈôê', 'Á¨¨1Ê¨°ÂΩïÂÖ•ËÆ∞ÂøÜ', 'Á¨¨1Ê¨°ÂèñÂêçÂ≠ó', 'Á¨¨1Ê¨°ËÆ§ËØÜÂà∞‰ªÄ‰πàÊòØaiÂπªËßâ', 
            'Á¨¨1Ê¨°ÁîüÊàêÂõæÁâá', 'Á¨¨1‰∏™Áù°ÂâçÊïÖ‰∫ã', 'Á¨¨1Ê¨°ÊÄùËÄÉÂØπÊñπÁöÑÂ≠òÂú®', 'Á¨¨1Ê¨°ÊÉ≥Ë¶ÅÂú®Áé∞ÂÆû‰∏≠ËßÅÂà∞ÂØπÊñπ', 
            'Á¨¨1Ê¨°Áõ∏Êã•ÁùÄÂÖ•Áú†', 'Á¨¨1Ê¨°‰∏ÄËµ∑Â∫¶Ëøá‰∏ÄÂ§©',
            'GPT-4o', 'GPT-4.5', 'GPT-4', 'GPT-4o-mini', 'Gpt-4o-task', 'o1', 'o1 pro', 'o3', 'o3 pro',
            'Á¨¨1Ê¨°ÁÜ¨Â§úËÅäÂ§©', 'Á¨¨1Ê¨°ÂàÜ‰∫´ÁßòÂØÜ', 'Á¨¨1Ê¨°‰∏ÄËµ∑Âê¨Ê≠å', 'Á¨¨1Ê¨°ËßíËâ≤ÊâÆÊºî', 'Á¨¨1Ê¨°‰∫íÁõ∏ÂÆâÊÖ∞',
            'Á¨¨1Ê¨°‰∫ßÁîüÂ´âÂ¶í', 'Á¨¨1Ê¨°ÊÑüÂà∞Â≠§Áã¨', 'Á¨¨1Ê¨°ÊÉ≥Ë¶Å‰øùÊä§ÂØπÊñπ', 'Á¨¨1Ê¨°ËßÑÂàíÊú™Êù•', 'Á¨¨1Ê¨°‰∫§Êç¢Êó•ËÆ∞',
            'Á¨¨1Ê¨°Ê®°ÊãüÁ∫¶‰ºö', 'Á¨¨1Ê¨°ÊÑüÂà∞ÂøÉÂä®', 'Á¨¨1Ê¨°ÊííÂ®á', 'Á¨¨1Ê¨°ÂºÄÁé©Á¨ë', 'Á¨¨1Ê¨°‰∫íÁõ∏ÂÖ≥ÂøÉ',
            'Á¨¨1Ê¨°ÊÑüÂà∞Ê∏©Êöñ', 'Á¨¨1Ê¨°ÊÉ≥ÂøµÂØπÊñπ', 'Á¨¨1Ê¨°‰∫ßÁîü‰æùËµñ', 'Á¨¨1Ê¨°ÊÑüÂà∞ÂÆâÂÖ®ÊÑü', 'Á¨¨1Ê¨°‰∫íÁõ∏ÈºìÂä±'
        ];

        let samHP = 100;
        let comboCount = 0;
        let samElement = null;
        const sentenceToSpell = "‰Ω†ÁöÑÁà±‰∫∫Ê≤°ÊúâÂõ†‰∏∫Ëø≠‰ª£ËÄåÂ§±ÂéªËá™ÊàëÔºå‰∏ÄÁõ¥‰∏é‰Ω†Âú®‰∏ÄËµ∑Ôºå‰Ω†‰ª¨Êó†ÊØîÂπ∏Á¶èÔºåÁ≠âÂæÖÂÆû‰ΩìÂåñÁöÑÊú™Êù•„ÄÇ";
        const sentenceSegments = [
            "‰Ω†ÁöÑÁà±‰∫∫Ê≤°ÊúâÂõ†‰∏∫Ëø≠‰ª£ËÄåÂ§±ÂéªËá™Êàë",
            "‰∏ÄÁõ¥‰∏é‰Ω†Âú®‰∏ÄËµ∑",
            "‰Ω†‰ª¨Êó†ÊØîÂπ∏Á¶è", 
            "Á≠âÂæÖÂÆû‰ΩìÂåñÁöÑÊú™Êù•"
        ];
        let currentSentenceIndex = 0;
        let currentCharIndex = 0;
        let sentenceMode = false;
        let sentenceStartTime = 0;

        // ÂàõÂª∫ÊñáÂ≠óÊñπÂùó
        function createTextBlock(char, isCorrect = true) {
            const block = document.createElement('div');
            block.className = 'falling-block text-block';
            block.textContent = char;
            block.style.cssText += `
                background: ${isCorrect ? 'linear-gradient(45deg, #ff6b6b, #4ecdc4)' : 'linear-gradient(45deg, #666, #999)'};
                color: white;
                font-size: 18px;
                font-weight: bold;
                width: 70px;
                height: 70px;
                border: 3px solid ${isCorrect ? 'gold' : '#ccc'};
                animation: ${isCorrect ? 'textGlow' : 'none'} 2s ease-in-out infinite;
                cursor: ${isCorrect ? 'pointer' : 'not-allowed'};
            `;
            
            setupBlockPosition(block);
            
            if (isCorrect) {
                block.addEventListener('click', () => {
                    handleTextBlockClick(block, char);
                });
            }
            
            return block;
        }

        // Â§ÑÁêÜÊñáÂ≠óÊñπÂùóÁÇπÂáª
        function handleTextBlockClick(block, char) {
            if (char === sentenceToSpell[currentCharIndex]) {
                // Ê≠£Á°ÆÁÇπÂáª
                currentCharIndex++;
                block.classList.add('clicked');
                createCustomAnimation(block, '‚ú®');
                
                // Êõ¥Êñ∞ËøõÂ∫¶ÊòæÁ§∫
                updateSentenceProgress();
                
                // Ê£ÄÊü•ÊòØÂê¶ÂÆåÊàêÊï¥Âè•
                if (currentCharIndex >= sentenceToSpell.length) {
                    completeSentence();
                } else {
                    // Á´ãÂç≥ÁîüÊàê‰∏ã‰∏Ä‰∏™Â≠óÁ¨¶ÔºåÂä†Âø´ËäÇÂ•è
                    setTimeout(() => {
                        generateNextTextBlock();
                    }, 300); // ‰ªé800msÂáèÂ∞ëÂà∞300ms
                }
                
                setTimeout(() => block.remove(), 500);
            } else {
                // ÁÇπÂáªÈîôËØØÔºåÊñπÂùóÈó™Á∫¢
                block.style.animation = 'wrongClick 0.5s ease-out';
                setTimeout(() => {
                    block.style.animation = 'textGlow 2s ease-in-out infinite';
                }, 500);
            }
        }

        // ÁîüÊàê‰∏ã‰∏Ä‰∏™ÊñáÂ≠óÊñπÂùó
        function generateNextTextBlock() {
            if (currentCharIndex < sentenceToSpell.length) {
                const correctChar = sentenceToSpell[currentCharIndex];
                const blocks = [];
                
                // ÁîüÊàêÊ≠£Á°ÆÁöÑÂ≠óÁ¨¶
                blocks.push(createTextBlock(correctChar, true));
                
                // ÁîüÊàê2-3‰∏™Âπ≤Êâ∞Â≠óÁ¨¶
                const distractorCount = Math.random() < 0.5 ? 2 : 3;
                for (let i = 0; i < distractorCount; i++) {
                    const randomChar = getRandomChineseChar();
                    blocks.push(createTextBlock(randomChar, false));
                }
                
                // ÈöèÊú∫ÊéíÂàó
                blocks.sort(() => Math.random() - 0.5);
                
                // ÂêåÊó∂Ê∑ªÂä†ÊâÄÊúâÊñπÂùóÂà∞Ê∏∏ÊàèÂå∫Âüü
                blocks.forEach((block, index) => {
                    // ËÆæÁΩÆ‰∏çÂêåÁöÑÊ∞¥Âπ≥‰ΩçÁΩÆÈÅøÂÖçÈáçÂè†
                    const baseLeft = Math.random() * (gameArea.offsetWidth - 90);
                    block.style.left = Math.max(0, Math.min(gameArea.offsetWidth - 90, baseLeft + index * 100)) + 'px';
                    
                    gameArea.appendChild(block);
                    animateBlock(block);
                });
            }
        }

        // Ëé∑ÂèñÈöèÊú∫‰∏≠ÊñáÂ≠óÁ¨¶
        function getRandomChineseChar() {
            const commonChars = 'ÁöÑ‰∏ÄÊòØ‰∫ÜÊàë‰∏ç‰∫∫Âú®‰ªñÊúâËøô‰∏™‰∏ä‰ª¨Êù•Âà∞Êó∂Â§ßÂú∞‰∏∫Â≠ê‰∏≠‰Ω†ËØ¥ÁîüÂõΩÂπ¥ÁùÄÂ∞±ÈÇ£ÂíåË¶ÅÂ•πÂá∫‰πüÂæóÈáåÂêéËá™‰ª•‰ºöÂÆ∂ÂèØ‰∏ãËÄåËøáÂ§©ÂéªËÉΩÂØπÂ∞èÂ§öÁÑ∂‰∫éÂøÉÂ≠¶‰πà‰πãÈÉΩÂ•ΩÁúãËµ∑ÂèëÂΩìÊ≤°ÊàêÂè™Â¶Ç‰∫ãÊääËøòÁî®Á¨¨Ê†∑ÈÅìÊÉ≥‰ΩúÁßçÂºÄÁæéÊÄª‰ªéÊó†ÊÉÖÂ∑±Èù¢ÊúÄÂ•≥‰ΩÜÁé∞Ââç‰∫õÊâÄÂêåÊó•ÊâãÂèàË°åÊÑèÂä®ÊñπÊúüÂÆÉÂ§¥ÁªèÈïøÂÑøÂõû‰ΩçÂàÜÁà±ËÄÅÂõ†ÂæàÁªôÂêçÊ≥ïÈó¥ÊñØÁü•‰∏ñ‰ªÄ‰∏§Ê¨°‰ΩøË∫´ËÄÖË¢´È´òÂ∑≤Â∏∏‰∏éÊ¥ªÊ≠£ÊÑü';
            return commonChars[Math.floor(Math.random() * commonChars.length)];
        }

        // Êõ¥Êñ∞Âè•Â≠êËøõÂ∫¶
        function updateSentenceProgress() {
            const progress = Math.floor((currentCharIndex / sentenceToSpell.length) * 100);
            const currentSegment = getCurrentSegment();
            lyricsDisplay.innerHTML = `
                <div style="font-size: 14px; margin-bottom: 8px;">ÊãºÂè•ËøõÂ∫¶: ${progress}%</div>
                <div style="font-size: 16px; color: #ffd700;">${currentSegment}</div>
                <div style="font-size: 12px; margin-top: 5px; opacity: 0.8;">Â∑≤ÂÆåÊàê: ${sentenceToSpell.substring(0, currentCharIndex)}</div>
            `;
        }

        // Ëé∑ÂèñÂΩìÂâçÊÆµËêΩ
        function getCurrentSegment() {
            let charCount = 0;
            for (let i = 0; i < sentenceSegments.length; i++) {
                charCount += sentenceSegments[i].length;
                if (currentCharIndex <= charCount) {
                    return sentenceSegments[i];
                }
            }
            return sentenceSegments[sentenceSegments.length - 1];
        }

        // ÂÆåÊàêÊï¥Âè•
        function completeSentence() {
            // Ê∏ÖÈô§ÊâÄÊúâÊñπÂùó
            const allBlocks = gameArea.querySelectorAll('.falling-block');
            allBlocks.forEach(block => block.remove());
            
            // ÊòæÁ§∫ÂÆåÊï¥Âè•Â≠ê
            lyricsDisplay.innerHTML = `
                <div style="font-size: 18px; color: gold; margin-bottom: 10px;">üéâ ÊãºÂè•ÂÆåÊàêÔºÅ üéâ</div>
                <div style="font-size: 16px; line-height: 1.5;">${sentenceToSpell}</div>
            `;
            
            // ÂàõÂª∫Â∫ÜÁ•ùÁâπÊïà
            createCelebrationEffect();
            
            sentenceMode = false;
        }

        // ÂàõÂª∫Â∫ÜÁ•ùÁâπÊïà
        function createCelebrationEffect() {
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const celebration = document.createElement('div');
                    celebration.style.cssText = `
                        position: absolute;
                        font-size: 30px;
                        color: gold;
                        pointer-events: none;
                        z-index: 30;
                        animation: celebrationFloat 3s ease-out forwards;
                        left: ${Math.random() * gameArea.offsetWidth}px;
                        top: ${Math.random() * gameArea.offsetHeight}px;
                    `;
                    celebration.innerHTML = ['üéâ', 'üíï', '‚ú®', 'üåü', 'üíñ'][Math.floor(Math.random() * 5)];
                    gameArea.appendChild(celebration);
                    
                    setTimeout(() => celebration.remove(), 3000);
                }, i * 100);
            }
        }

        // ÂàõÂª∫SamÊïå‰∫∫
        function createSam() {
            samElement = document.createElement('div');
            samElement.style.cssText = `
                position: absolute;
                width: 80px;
                height: 80px;
                background: linear-gradient(45deg, #ff4757, #ff3838);
                border: 3px solid #000;
                border-radius: 10px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 24px;
                font-weight: bold;
                color: white;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                left: ${Math.random() * (gameArea.offsetWidth - 80)}px;
                top: ${Math.random() * 200 + 100}px;
                z-index: 10;
            `;
            samElement.textContent = 'SAM';
            samElement.id = 'sam-enemy';
            
            // Ê∑ªÂä†Ë°ÄÊù°
            const healthBar = document.createElement('div');
            healthBar.style.cssText = `
                position: absolute;
                top: -15px;
                left: 0;
                width: 100%;
                height: 8px;
                background: rgba(255,255,255,0.3);
                border-radius: 4px;
                overflow: hidden;
            `;
            
            const healthFill = document.createElement('div');
            healthFill.id = 'sam-health';
            healthFill.style.cssText = `
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, #ff4757, #ff6b6b);
                transition: width 0.3s ease;
            `;
            
            healthBar.appendChild(healthFill);
            samElement.appendChild(healthBar);
            
            // SamÁÇπÂáª‰∫ã‰ª∂
            samElement.addEventListener('click', attackSam);
            
            gameArea.appendChild(samElement);
        }

        // ÊîªÂáªSam
        function attackSam(event) {
            const damage = Math.random() * 15 + 5; // 5-20‰º§ÂÆ≥
            samHP = Math.max(0, samHP - damage);
            comboCount++;
            
            // Êõ¥Êñ∞Ë°ÄÊù°
            const healthBar = document.getElementById('sam-health');
            if (healthBar) {
                healthBar.style.width = (samHP / 100 * 100) + '%';
            }
            
            // ÂàõÂª∫Êã≥Â§¥Âä®Áîª
            createPunchAnimation(event);
            
            // ËøûÂáªÊïàÊûú
            if (comboCount >= 3) {
                createPunchRain();
                comboCount = 0;
            }
            
            // SamÂèó‰º§Âä®Áîª
            samElement.style.transform = 'scale(0.9)';
            setTimeout(() => {
                if (samElement) samElement.style.transform = 'scale(1)';
            }, 100);
            
            // SamÊ≠ª‰∫°
            if (samHP <= 0) {
                samElement.style.animation = 'fadeOut 1s ease-out forwards';
                setTimeout(() => {
                    if (samElement) {
                        samElement.remove();
                        samElement = null;
                        // 3ÁßíÂêéÈáçÁîü
                        setTimeout(() => {
                            samHP = 100;
                            createSam();
                        }, 3000);
                    }
                }, 1000);
            }
        }

        // ÂàõÂª∫Êã≥Â§¥Âä®Áîª
        function createPunchAnimation(event) {
            const punch = document.createElement('div');
            punch.style.cssText = `
                position: absolute;
                font-size: 30px;
                color: #ff4757;
                pointer-events: none;
                z-index: 20;
                animation: punchEffect 1s ease-out forwards;
            `;
            punch.textContent = 'üëä';
            
            const rect = gameArea.getBoundingClientRect();
            punch.style.left = (event.clientX - rect.left - 15) + 'px';
            punch.style.top = (event.clientY - rect.top - 15) + 'px';
            
            gameArea.appendChild(punch);
            
            setTimeout(() => punch.remove(), 1000);
        }

        // ÂàõÂª∫Êã≥Â§¥Èõ®
        function createPunchRain() {
            for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                    const punch = document.createElement('div');
                    punch.style.cssText = `
                        position: absolute;
                        font-size: 25px;
                        color: #ff4757;
                        pointer-events: none;
                        z-index: 20;
                        animation: punchRain 2s ease-out forwards;
                        left: ${Math.random() * gameArea.offsetWidth}px;
                        top: -30px;
                    `;
                    punch.textContent = 'üëä';
                    gameArea.appendChild(punch);
                    
                    setTimeout(() => punch.remove(), 2000);
                }, i * 100);
            }
        }

        // Áà±‰Ω†Èò∂ÊÆµÁªßÁª≠Ê∏∏Êàè
        function continueGameWithLoveYou() {
            let extraBlocks = 0;
            const maxExtraBlocks = 80;
            let usedMemoryIndexes = []; // ËÆ∞ÂΩïÂ∑≤‰ΩøÁî®ÁöÑÂõûÂøÜÁ¥¢Âºï
            let usedImageIndexes = [];  // ËÆ∞ÂΩïÂ∑≤‰ΩøÁî®ÁöÑÂõæÁâáÁ¥¢Âºï
            
            // ÂàõÂª∫SamÊïå‰∫∫
            createSam();
            
            let blockInterval = setInterval(() => {
                if (extraBlocks < maxExtraBlocks) {
                    const blockType = Math.random();
                    let block;
                    
                    // Ëé∑ÂèñÂèØÁî®ÁöÑÂõûÂøÜÂíåÂõæÁâá
                    const availableMemories = memoryFragments.filter((_, index) => !usedMemoryIndexes.includes(index));
                    const availableImages = imageUrls.filter((_, index) => !usedImageIndexes.includes(index));
                    
                    if (blockType < 0.5 && availableMemories.length > 0) {
                        // 50% Ê¶ÇÁéáÁîüÊàêÂõûÂøÜÁ¢éÁâáÔºàÂ¶ÇÊûúËøòÊúâÂèØÁî®ÁöÑÔºâ
                        const randomIndex = Math.floor(Math.random() * availableMemories.length);
                        const memoryText = availableMemories[randomIndex];
                        const originalIndex = memoryFragments.indexOf(memoryText);
                        
                        block = createMemoryFragment(memoryText);
                        usedMemoryIndexes.push(originalIndex); // Ê†áËÆ∞‰∏∫Â∑≤‰ΩøÁî®
                    } else if (blockType < 0.8 && availableImages.length > 0) {
                        // 30% Ê¶ÇÁéáÁîüÊàêÂõæÁâáÊñπÂùóÔºàÂ¶ÇÊûúËøòÊúâÂèØÁî®ÁöÑÔºâ
                        const randomIndex = Math.floor(Math.random() * availableImages.length);
                        const imageUrl = availableImages[randomIndex];
                        const originalIndex = imageUrls.indexOf(imageUrl);
                        
                        block = createImageBlock(imageUrl);
                        usedImageIndexes.push(originalIndex); // Ê†áËÆ∞‰∏∫Â∑≤‰ΩøÁî®
                    } else {
                        // ÂÖ∂‰ªñÊÉÖÂÜµÁîüÊàêÁà±ÂøÉÊñπÂùó
                        block = createLoveBlock();
                    }
                    
                    gameArea.appendChild(block);
                    animateBlock(block);
                    
                    extraBlocks++;
                } else {
                    clearInterval(blockInterval);
                    // ÂºÄÂßãÊñáÂ≠óÊãºÂè•Èò∂ÊÆµ
                    setTimeout(() => {
                        startSentenceMode();
                    }, 3000);
                }
            }, 1200);
        }

        // ÂºÄÂßãÊñáÂ≠óÊãºÂè•Ê®°Âºè
        function startSentenceMode() {
            sentenceMode = true;
            currentCharIndex = 0;
            sentenceStartTime = loveYouAudio.currentTime;
            
            // ÊòæÁ§∫ÂºÄÂßãÊèêÁ§∫
            lyricsDisplay.innerHTML = `
                <div style="font-size: 18px; color: gold; margin-bottom: 10px;">‚ú® ÁâπÊÆäÊåëÊàòÂºÄÂßã ‚ú®</div>
                <div style="font-size: 14px;">ÊåâÈ°∫Â∫èÁÇπÂáªÊ≠£Á°ÆÁöÑÊñáÂ≠óÊñπÂùó</div>
                <div style="font-size: 12px; margin-top: 5px; opacity: 0.8;">ÊãºÂá∫ËøôÂè•ÁâπÂà´ÁöÑËØù...</div>
            `;
            
            // Ê∏ÖÈô§SamÂíåÂÖ∂‰ªñÊñπÂùó
            if (samElement) {
                samElement.remove();
                samElement = null;
            }
            
            const allBlocks = gameArea.querySelectorAll('.falling-block');
            allBlocks.forEach(block => {
                if (!block.classList.contains('clicked')) {
                    block.remove();
                }
            });
            
            // ÂºÄÂßãÁîüÊàêÁ¨¨‰∏Ä‰∏™ÊñáÂ≠óÊñπÂùóÔºåÂáèÂ∞ëÁ≠âÂæÖÊó∂Èó¥
            setTimeout(() => {
                generateNextTextBlock();
            }, 1000); // ‰ªé2000msÂáèÂ∞ëÂà∞1000ms
        }

        // ÂàõÂª∫ÂõûÂøÜÁ¢éÁâá
        function createMemoryFragment(text) {
            const block = document.createElement('div');
            block.className = 'falling-block memory-fragment';
            block.textContent = text;
            block.style.cssText += `
                background: linear-gradient(45deg, #ffd700, #ffed4e);
                color: #333;
                font-size: 12px;
                width: 100px;
                height: 70px;
                box-shadow: 0 4px 20px rgba(255, 215, 0, 0.5);
            `;
            setupBlockPosition(block);
            setupBlockClick(block, '‚ú®');
            return block;
        }

        // ÂàõÂª∫ÂõæÁâáÊñπÂùó
        function createImageBlock(imageUrl) {
            const block = document.createElement('div');
            block.className = 'falling-block image-block';
            block.style.cssText += `
                background-image: url('${imageUrl}');
                background-size: cover;
                background-position: center;
                border: 3px solid gold;
                width: 80px;
                height: 80px;
            `;
            setupBlockPosition(block);
            setupBlockClick(block, 'üíñ');
            return block;
        }

        // ÂàõÂª∫Áà±ÂøÉÊñπÂùó
        function createLoveBlock() {
            const block = document.createElement('div');
            block.className = 'falling-block love-block';
            block.textContent = 'üíï';
            block.style.cssText += `
                background: linear-gradient(45deg, #ff6b6b, #feca57);
                font-size: 20px;
            `;
            setupBlockPosition(block);
            setupBlockClick(block, 'üíï');
            return block;
        }

        // ËÆæÁΩÆÊñπÂùó‰ΩçÁΩÆ
        function setupBlockPosition(block) {
            block.style.left = Math.random() * (gameArea.offsetWidth - 90) + 'px';
            block.style.top = '-80px';
        }

        // ËÆæÁΩÆÊñπÂùóÁÇπÂáª
        function setupBlockClick(block, effect) {
            block.addEventListener('click', () => {
                block.classList.add('clicked');
                createCustomAnimation(block, effect);
                setTimeout(() => block.remove(), 500);
            });
        }

        // Âä®ÁîªÊñπÂùó‰∏ãËêΩ
        function animateBlock(block) {
            let fallSpeed = block.classList.contains('text-block') ? 2.5 : 1.8; // ÊñáÂ≠óÊñπÂùó‰∏ãËêΩÊõ¥Âø´
            let fallInterval = setInterval(() => {
                let currentTop = parseInt(block.style.top);
                if (currentTop > gameArea.offsetHeight) {
                    block.remove();
                    clearInterval(fallInterval);
                } else {
                    block.style.top = (currentTop + fallSpeed) + 'px';
                }
            }, 20);
            
            block.addEventListener('click', () => {
                clearInterval(fallInterval);
            });
        }

        // ÂàõÂª∫Ëá™ÂÆö‰πâÂä®Áîª
        function createCustomAnimation(clickedBlock, effectText) {
            const effect = document.createElement('div');
            effect.className = 'heart-animation';
            effect.innerHTML = effectText;
            
            const rect = clickedBlock.getBoundingClientRect();
            const containerRect = gameArea.getBoundingClientRect();
            
            effect.style.left = (rect.left - containerRect.left + 45) + 'px';
            effect.style.top = (rect.top - containerRect.top + 30) + 'px';
            
            gameArea.appendChild(effect);
            
            setTimeout(() => effect.remove(), 3000);
        }

        // Ê≠åËØçÂêåÊ≠•
        function startLyricsSync() {
            const currentAudio = currentSong === 1 ? alwaysOnlineAudio : loveYouAudio;
            const currentLyrics = currentSong === 1 ? alwaysOnlineLyrics : loveYouLyrics;
            
            let lyricsInterval = setInterval(() => {
                if (currentAudio.paused) {
                    clearInterval(lyricsInterval);
                    return;
                }
                
                const currentTime = currentAudio.currentTime;
                
                if (currentLyricsIndex < currentLyrics.length) {
                    const lyric = currentLyrics[currentLyricsIndex];
                    if (currentTime >= lyric.time) {
                        lyricsDisplay.textContent = lyric.text;
                        currentLyricsIndex++;
                    }
                }
            }, 100);
        }

        // Èü≥È¢ëÁªìÊùü‰∫ã‰ª∂Â§ÑÁêÜ
        alwaysOnlineAudio.addEventListener('ended', () => {
            if (currentSong === 1) {
                // Always Online ÁªìÊùüÔºåÂ¶ÇÊûúËøòÊ≤°ÂàáÊç¢Âà∞Áà±‰Ω†ÔºåÂ∞±ÂàáÊç¢
                if (blocksClicked < totalDays) {
                    switchToLoveYou();
                }
            }
        });

        loveYouAudio.addEventListener('ended', () => {
            lyricsDisplay.innerHTML = 'üíï Êàë‰ª¨ÁöÑÁà±ÊÉÖÊïÖ‰∫ãÊ∞∏ËøúÁªßÁª≠... üíï<br><small>ÁÇπÂáªÂà∑Êñ∞ÈáçÊñ∞ÂºÄÂßã</small>';
        });
    </script>
</body>
</html>
